<script src="config.js" type="text/javascript"></script>
<script src="oidc-client.min.js" type="text/javascript"></script>
<script src="jwt-decode.js" type="text/javascript"></script>
<script>
  Oidc.Log.logger = console;
  Oidc.Log.level = Oidc.Log.DEBUG;
  const oidcClient = new Oidc.OidcClient(config);
  (async function() {
    try {
      const response = await oidcClient.processSigninResponse(location.href);
      console.log(response)
      const IDToken = response.id_token;
      const decoded = jwt_decode(IDToken);
      const address = decoded.sub;
      console.log(`ID token:\n${JSON.stringify(decoded, null, '')}`);
      document.getElementById('user-id').innerText = `${address}`;
      document.getElementById('grant-access-oasis').addEventListener('click', function () {
        location.assign(grantUrl(address));
      });
    } catch (error) {
      document.getElementById('user-id').hidden = true;
      document.getElementById('grant-access-oasis').hidden = true;
      document.getElementById('response').innerText = `${error}`;
    }
  })();
</script>

<span>Your user id is</span>
<button id="user-id" data-cy="user-id"></button>
<button id="grant-access-oasis" data-cy="grant-access-oasis"></button>
<p id="response" data-cy="response"></p>